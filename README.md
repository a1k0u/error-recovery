# Стратегии восстановление после ошибок 🧐

### Обнаружение ошибок

### Виды ошибок

### Различные способы восстановиться после ошибок

### Почему восстановление после ошибок - важная задача парсера

Парсер, при обнаружении синтаксической ошибки, понимает, что входная цепочка не принадлежит языку и может сообщить об ошибке пользователю.

Но это не совсем то поведение, которое ожидается от парсера. Мы, в первую очередь, ожидаем, что парсер сообщит о всех синтаксических ошибках, допущенных во входной цепочке. Поэтому парсер должен уметь при обнаружении ошибки сообщить о ней и продолжить парсинг дальше.

Во многом для решения такой задачи и существует механизмы восстановления после ошибок.

### Phrase mode
- Описание:
  - В этой стратегии при нахождении локальных ошибок парсер
  самостоятельно изменяет входные данные для того,
  чтобы продолжить свою работу. Считается, что после 
  исправления локальной ошибки, оставшаяся часть текста
  позволит парсеру продолжить свою работу.

- Использование:
  - В целом, разработчик сам решает какие первоначальные
  изменения добавить в свой компилятор. В основном 
  эту стратегию используют, чтобы убрать/добавить/переставить знак
  конца строки.

- Преимущества:
  - Метод используется в большинстве компиляторов.
  - Легко встраивается в различные грамматики.

- Недостатки:
  - При неправильном анализе локальной ошибки перестановка
  может вызвать бесконечную (_некорректную_) работу парсера.

- Производительность: 
  - ...

```javascript
let a, b

// after error recovery ->

let a, b;
```

### Error production
- Описание
  - Error production - один из методов восстановления после ошибок типа Ad Hoc. Основная идея метода Error production в том, что теперь некоторые синтаксические ошибки становятся частью грамматики. При этом синтаксис самого языка не меняется. Изменения в грамматику вносятся для того, чтобы цепочки, которые не лежат в языке, можно было обработать и продолжить парсинг.

- Преимущества
  - Разработчик парсера понимает, какие синтаксические ошибки встречаются чаще всего (ex. после statement пропущен semicolon) и может обработать именно их.
  - Метод можно использовать в совокупности с другими методами восстановления. Это удобно, потому что Error production не может обработать все ошибки, а только те, о которых подумали разработчики парсера, тем не менее часто он бывает удобнее других методов.
  - Хорошо читаемые сообщения об ошибках.

- Недостатки
  - При изменении грамматики языка, меняется и грамматика, которая позволяет находить ошибки. Тяжело поддерживать в крупных проектах.
  - Невозможно обработать все ошибки, а только те, о которых подумал разработчик парсера.

- Производительность
  - Основная суть метода `Error production` в том, что мы добавляем выводы в грамматику, которые позволяют нам обрабатывать ошибки. Добавление выводов в грамматику не влияют на производительность парсера.
- Реализация стратегии на языке `Python`
  - [Error-prodcution](./error-production)


#### Пример использования метода:

Синтаксис условного оператора в языке `C++` выглядит следующим образом:

```C++
if (expr) {
    statement;
}
```

Одна из частых синтаксических ошибок - отсутствие скобок вокруг `boolean-expression`. Давайте добавим такую ошибку в грамматику языка:

```
S -> IF ROPAR boolean-expr RCPAR FOPAR statement FCPAR
S -> IF boolean-expr FOPAR statement FCPAR
IF -> if
ROPAR -> (
RCPAR -> )
FOPAR -> {
FCPAR -> }
```

В случае если вы вывели цепочку языка по правилу `S -> IF boolean-expr FOPAR statement FCPAR` мы можем сообщить об ошибке, при этом парсинг продолжится.

### Сравнение стратегий

### Заключение

### В ходе выполнения

>By Alexander Vinogradov, Alexey Kosenko and Roman Gostilo.
>
>**@** _group project of formal languages, 2022_
